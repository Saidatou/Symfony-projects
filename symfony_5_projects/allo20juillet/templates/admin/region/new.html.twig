{% extends 'base.html.twig' %}

{# {% block title %}New Region
{% endblock %}

{% block body %}
	<h1>Ajouter une Région</h1>

	{{ include('admin/region/_form.html.twig') }}

	<a href="{{ path('region_index') }}">back to list</a>
{% endblock %} #}

{# ci dessous tout le code #}
{# {% extends 'base.html.twig' %}#}
	{% block title %}
Ajouter une région
{% endblock %}

	{% block body %}
		<h1 class="text-center"> Ajouter une région
	</h1>
	{{ include('admin/region/_form.html.twig') }}

	<a href="{{ path('region_index') }}">back to list</a>
{% endblock %}


{#{% block javascripts %}
	<script>
		// declaration de la collection qui est la div département, du boutonAjout, et du span  ci-dessous
let collection,
boutonAjout,
span;
// chargement du document
window.onload = () => {
collection = document.querySelector("#departements");
span = collection.querySelector("span");
// création du bouton ajout
boutonAjout = document.createElement("button");
// on donne une class au bouton et une couleur bleu-ciel
boutonAjout.className = "ajout-departement btn btn-info";
// le texte qui apparaîtra sur le bouton
boutonAjout.innerText = "Ajouter un département";
// faire apparaître le bouton par le biai du span
let nouveauBouton = span.append(boutonAjout);
// Voir combien nous avaons de input dans notre collection
collection.dataset.index = collection.querySelectorAll("input").length;
// mettre un écouteur d'évenement sur le bouton ajout
boutonAjout.addEventListener("click", function () { // on donne le nom AddButton à cette fonction avec en paramètre la collection et le nouveau bouton
addButton(collection, nouveauBouton);
});
}
function addButton(collection, nouveauBouton) {
let prototype = collection.dataset.prototype;
let index = collection.dataset.index;
prototype = prototype.replace(/__name__/g, index);
let content = document.createElement("html");
content.innerHTML = prototype;
let newForm = content.querySelector("div");
let boutonSuppr = document.createElement("button");
boutonSuppr.type = "button";
boutonSuppr.className = "btn btn-danger";
boutonSuppr.id = "delete-departement-" + index;
boutonSuppr.innerText = "Supprimer ce département";
newForm.append(boutonSuppr);
collection.dataset.index ++;
let boutonAjout = collection.querySelector(".ajout-departement");
span.insertBefore(newForm, boutonAjout);
boutonSuppr.addEventListener("click", function () {
this.previousElementSibling.parentElement.remove();
})
}
	</script>
{% endblock %}#}

{% block javascripts %}
	<script>
		let collection,
boutonAjout,
span;
window.onload = () => {
collection = document.querySelector("#departements");
span = collection.querySelector("span");
boutonAjout = document.createElement("button");
boutonAjout.className = "ajout-departement btn secondary";
boutonAjout.innerText = "Ajouter un département";
let nouveauBouton = span.append(boutonAjout);
collection.dataset.index = collection.querySelectorAll("input").length;
boutonAjout.addEventListener("click", function () {
addButton(collection, nouveauBouton);
});
}
function addButton(collection, nouveauBouton) {
let prototype = collection.dataset.prototype;
let index = collection.dataset.index;
prototype = prototype.replace(/__name__/g, index);
let content = document.createElement("html");
content.innerHTML = prototype;
let newForm = content.querySelector("div");
let boutonSuppr = document.createElement("button");
boutonSuppr.type = "button";
boutonSuppr.className = "btn red";
boutonSuppr.id = "delete-departement-" + index;
boutonSuppr.innerText = "Supprimer ce département";
newForm.append(boutonSuppr);
collection.dataset.index ++;
let boutonAjout = collection.querySelector(".ajout-departement");
span.insertBefore(newForm, boutonAjout);
boutonSuppr.addEventListener("click", function () {
this.previousElementSibling.parentElement.remove();
})
}
	</script>
{% endblock %}
